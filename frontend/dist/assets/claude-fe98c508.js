import{u as e,j as a,I as t,B as s,a8 as n,r as i,a6 as l,W as o,X as r}from"./index-8bf8489d.js";import{o as c,P as d,D as m,a as u,b as x,d as h,s as j,T as p,S as k}from"./ShareModal-20b6362a.js";import{R as y,u as f}from"./RobotOutlined-5230b30c.js";import{T as w,E as g}from"./index-57131342.js";import{F as N}from"./index-83bdf3a0.js";import{u as q}from"./useQuery-e775fa21.js";import{R as S,C as I}from"./row-b45105b9.js";function C(){const{t:C}=e(),b=[{key:"email",title:C("token.email"),dataIndex:["account","email"],width:120,render:e=>a.jsx(t,{value:e,onClick:a=>c(e,C,a),readOnly:!0})},{key:"uniqueName",title:"Unique Name",dataIndex:"uniqueName",align:"center",width:120},{key:"password",title:C("token.password"),dataIndex:"password",align:"center",width:120},{key:"expiresAt",title:C("token.expiresAt"),dataIndex:"expiresAt",align:"center",width:120,render:e=>""==e?"未知":e},{key:"comment",title:C("token.comment"),dataIndex:"comment",align:"center",render:e=>a.jsx(w.Text,{style:{maxWidth:500},ellipsis:!0,children:e})},{title:C("token.action"),key:"operation",align:"center",render:(e,t)=>a.jsxs(s.Group,{children:[a.jsx(n,{title:"登录并跳转至对话",placement:"bottom",children:a.jsx(s,{icon:a.jsx(y,{}),type:"primary",onClick:()=>B(t)})}),a.jsx(s,{icon:a.jsx(g,{}),type:"primary",onClick:()=>U(t)}),a.jsx(d,{title:C("token.deleteConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>D(t),children:a.jsx(s,{icon:a.jsx(m,{}),type:"primary",loading:R==t.accountId+t.uniqueName,danger:!0})})]})}],v=u(),F=x(),[T,L]=i.useState(!1),O=f(),[W]=N.useForm(),z=N.useWatch("email",W),A=N.useWatch("uniqueName",W),[R,V]=i.useState(void 0),[E,K]=i.useState({formValue:{...h},title:C("token.edit"),show:!1,onOk:e=>{K((e=>({...e,show:!1})))},onCancel:()=>{K((e=>({...e,show:!1})))}});i.useEffect((()=>{W.setFieldValue("email",O.get("email"))}),[O]);const U=e=>{K({formValue:e,title:C("token.edit"),show:!0,onOk:(e,a)=>{F.mutate(e,{onSuccess:()=>{K((e=>({...e,show:!1})))},onSettled:()=>a(!1)})},onCancel:()=>{K((e=>({...e,show:!1})))}})},B=e=>{L(!0),l.info({content:"正在跳转至对话...",key:"chatLogin",duration:5}),j.chatLoginShare(e.uniqueName,e.password).then((e=>{e&&window.open(e,"_blank")})).finally((()=>{L(!1)}))},D=e=>{V(e.accountId+e.uniqueName),v.mutate(e,{onSettled:()=>{V(void 0)}})},{data:G}=q({queryKey:["shareList","claude",z,A],queryFn:()=>j.searchShare("claude",z,A)});return a.jsxs(o,{direction:"vertical",size:"large",className:"w-full",children:[a.jsx(r,{children:a.jsx(N,{form:W,children:a.jsxs(S,{gutter:[16,16],children:[a.jsx(I,{span:6,lg:6,children:a.jsx(N.Item,{label:C("token.email"),name:"email",className:"!mb-0",children:a.jsx(t,{})})}),a.jsx(I,{span:6,lg:6,children:a.jsx(N.Item,{label:"Unique Name",name:"uniqueName",className:"!mb-0",children:a.jsx(t,{})})}),a.jsx(I,{span:12,lg:12,children:a.jsxs("div",{className:"flex justify-end",children:[a.jsx(s,{onClick:()=>{W.resetFields()},children:C("token.reset")}),a.jsx(s,{type:"primary",className:"ml-4",onClick:()=>{W.validateFields().then((e=>{W.submit()}))},children:C("token.search")})]})})]})})}),a.jsx(r,{title:C("token.shareList"),children:a.jsx(p,{rowKey:e=>e.accountId+e.uniqueName,size:"small",scroll:{x:"max-content"},pagination:{pageSize:10},columns:b,dataSource:G,loading:T})}),a.jsx(k,{...E})]})}export{C as default};
